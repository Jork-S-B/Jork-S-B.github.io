# APPæµ‹è¯•

## ğŸ“Œ å…³äºç¯å¢ƒ

ç°åº¦ç¯å¢ƒ/ç‰ˆæœ¬ï¼šå°‘é‡æœºå™¨å‘ç‰ˆï¼Œä¸èƒ½å½±å“ç”¨æˆ·ä½¿ç”¨ã€‚

å†…æµ‹æ—¶åˆ†å‘å¹³å°ï¼šäºŒç»´ç ä¸‹è½½ã€è’²å…¬è‹±ã€fir.im

ä¸Šçº¿æ—¶å‘å¸ƒå¹³å°ï¼š

* å®‰å“ï¼šè±Œè±†èšã€åº”ç”¨å®ã€360æ‰‹æœºåŠ©æ‰‹ã€å“ç‰Œå•†åŸã€‚
* IOSï¼šAppStoreã€iTools

ä¸Šçº¿ï¼šappå‘ç»™å¹³å°æ–¹å®¡æ ¸åï¼Œå°†è·å–åˆ°çš„å¹³å°å·æ‰“åŒ…è‡³appï¼Œå†è¿›è¡Œå†’çƒŸæµ‹è¯•ï¼Œæœ€åæ­£å¼æäº¤å‘å¸ƒã€‚

## ğŸ“Œ APPæµ‹è¯•è¦ç‚¹

* åŠŸèƒ½æµ‹è¯•
* å…¼å®¹æ€§æµ‹è¯•
* å®‰è£…/å¸è½½/å‡çº§æµ‹è¯•
* äº¤å‰äº‹ä»¶æµ‹è¯•
* PUSHæµ‹è¯•
* æ€§èƒ½æµ‹è¯•
* ç”¨æˆ·ä½“éªŒæµ‹è¯•
* ç¨³å®šæ€§æµ‹è¯•

### ğŸš å…¼å®¹æ€§æµ‹è¯•

æ¦‚æ‹¬ï¼šå…¼å®¹ä¸åŒæ“ä½œç³»ç»Ÿç‰ˆæœ¬ã€ä¸åŒå‚å•†

\#todoï¼Œç‰ˆæœ¬ä¸Šè½½å…¼å®¹æ€§çš„æµ‹è¯•ç­–ç•¥

1. æ‰‹æœºå‹å·
    * ä¸»æµæœºå‹ï¼šä¸‰æ˜Ÿã€å°ç±³ã€OPPOã€åä¸º
    * ç”¨æˆ·æœºå‹æ’åï¼šç§»åŠ¨è®¾å¤‡ä»½é¢ç»Ÿè®¡ã€`https://screensiz.es/`
2. å®‰å“ï¼š4.4ä»¥ä¸Šï¼ˆ5.1ã€6.0ã€7.0ï¼‰ï¼›iosï¼š9.xä»¥ä¸Š
3. å±å¹•å°ºå¯¸ï¼ˆ5.5ã€4.7ï¼‰ã€åˆ†è¾¨ç‡ï¼ˆ`1080*1920`ã€`720*1280`ï¼‰
4. ç½‘ç»œç½‘é€Ÿ
5. åº”ç”¨å…¼å®¹æ€§
    * ä¸æ‰‹æœºç¡¬ä»¶å…¼å®¹ï¼šæ‰‹æœºæŒ‰é”®ã€éŸ³é‡è°ƒèŠ‚ç­‰
    * ä¸å¤–éƒ¨è®¾å¤‡ç¡¬ä»¶å…¼å®¹ï¼šè€³æœºã€è“ç‰™ç­‰
    * ä¸æ“ä½œç³»ç»Ÿè½¯ä»¶å…¼å®¹ï¼šå®šä½ã€å­—ä½“è®¾ç½®ç­‰
    * ä¸å…¶ä»–APPå…¼å®¹ï¼šä¸»è¦æ˜¯æ’­æ”¾å™¨
6. ç¬¬ä¸‰æ–¹äº‘æµ‹å¹³å°

### ğŸš å®‰è£…/å¸è½½/å‡çº§æµ‹è¯•

å±äºæ–°åŠŸèƒ½æ—¶ä¸“é¡¹æµ‹è¯•

* å®‰è£…æµ‹è¯•ç‚¹

    1. æ­£å¸¸åœºæ™¯ï¼š

        1. åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿç‰ˆæœ¬å®‰è£…
        2. ä»ä¸åŒå®‰è£…æ¸ é“å®‰è£…
        3. ä¸åŒçš„å®‰è£…è·¯å¾„ï¼ˆæ‰‹æœº/SDå¡ï¼‰
        4. ä¸‹è½½æ—¶æ–­ç‚¹ç»­ä¼ 

    2. å¼‚å¸¸åœºæ™¯ï¼š

        1. å®‰è£…æ—¶å¼‚å¸¸ï¼ˆå…³æœºã€æ–­ç½‘ç­‰ï¼‰ï¼Œæ¢å¤åç»§ç»­å®‰è£…
        2. å®‰è£…æ—¶å­˜å‚¨ç©ºé—´ä¸è¶³
        3. å®‰è£…æ—¶æ‰‹åŠ¨å–æ¶ˆåå†æ¬¡å®‰è£…
        4. APPæ­£åœ¨è¿è¡Œæ—¶å®‰è£…
        5. ä½ç‰ˆæœ¬è¦†ç›–é«˜ç‰ˆæœ¬
        6. å¸è½½åå®‰è£…

---

* å¸è½½æµ‹è¯•ç‚¹

    1. æ­£å¸¸å¸è½½ï¼ˆAPPæ‰‹åŠ¨å¸è½½ã€å·¥å…·å¸è½½ï¼‰
    2. è¿è¡Œæ—¶å¸è½½
    3. å–æ¶ˆå¸è½½ï¼Œå›æ»šæ–‡ä»¶
    4. å¸è½½å¼‚å¸¸ä¸­æ–­
    5. å¸è½½åæ®‹ç•™æ•°æ®ã€ç”¨æˆ·æ–‡ä»¶

---

* å‡çº§æµ‹è¯•ï¼šå‡çº§åéœ€è¦å†’çƒŸæµ‹è¯•

    1. ä¸´è¿‘ç‰ˆæœ¬å‡çº§
    2. è·¨ç‰ˆæœ¬å‡çº§
    3. ä¸åŒæ¸ é“å‡çº§
    4. å‡çº§æé†’ï¼ˆæ— å¤§æ”¹åŠ¨å¯ä¸æé†’ã€æ–°åŠŸèƒ½æç¤ºå‡çº§ã€é‡å¤§bugæˆ–æ•°æ®ç»“æ„æ”¹åŠ¨éœ€å¼ºåˆ¶å‡çº§ï¼‰
    5. åº”ç”¨å‡çº§åœ¨éWIFIç¯å¢ƒæ—¶æé†’

### ğŸš äº¤å‰äº‹ä»¶æµ‹è¯•

åˆç§°å†²çªæµ‹è¯•ã€å¹²æ‰°æµ‹è¯•ï¼Œå¦‚appè¿è¡Œæ—¶æ¥å¬ç”µè¯ã€æ”¶å‘çŸ­ä¿¡ã€åº”ç”¨æ¨é€ã€è¿æ¥è“ç‰™ã€æ¥æ”¶æ–‡ä»¶å¼¹çª—ã€å±å¹•æ—‹è½¬ã€åˆ‡æ¢ç½‘ç»œç¯å¢ƒã€ç›¸æœºè®¡ç®—æœºç­‰è‡ªå¸¦åº”ç”¨ã€ç”µé‡å‘Šè­¦ç­‰ã€‚

### ğŸš PUSHæµ‹è¯•

å³æ¶ˆæ¯é€šçŸ¥ï¼Œåˆ†ä¸ºå¦‚ä¸‹ä¸¤ç§æ–¹å¼ï¼š

* pulléœ€è¦å®¢æˆ·ç«¯ä¸æ–­ç›‘æµ‹æœåŠ¡å™¨å˜åŒ–
* pushä¸»åŠ¨æ¨é€/è¢«åŠ¨æ¨é€-è§¦å‘äº‹ä»¶

æµ‹è¯•ç‚¹ï¼š

1. æ˜¯å¦æ ¹æ®å¯¹åº”ä¸šåŠ¡è§„åˆ™æ¨é€
2. æ˜¯å¦æ ¹æ®æŒ‡å®šç”¨æˆ·ã€è§’è‰²æ¨é€
3. æ˜¯å¦ä¸æ‰‹æœºé€šçŸ¥è®¾ç½®ä¸€è‡´ï¼ˆä¸å…è®¸é€šçŸ¥ã€æ˜¾ç¤ºä½ç½®ç­‰ï¼‰
4. appåœ¨ä½¿ç”¨æ—¶ã€åå°è¿è¡Œæ—¶ã€ç¦»çº¿æ—¶ï¼Œpushæ¶ˆæ¯èƒ½å¦æ­£å¸¸æç¤º

### ğŸš æ€§èƒ½æµ‹è¯•

* æœåŠ¡å™¨ç«¯ï¼Œå‚è€ƒ[JMeteræ€§èƒ½æµ‹è¯•](../test_performance/)
* APPæ€§èƒ½æµ‹è¯•å¸¸è§æŒ‡æ ‡åŒ…æ‹¬ï¼šCPUã€å†…å­˜ã€æµé‡æµ‹è¯•/å¼±ç½‘æµ‹è¯•ã€ç”µé‡æµ‹è¯•ã€æµç•…åº¦æµ‹è¯•ã€å¯åŠ¨é€Ÿåº¦ï¼ˆä¸åŒè½¯ä»¶åˆ‡æ¢ï¼‰

### ğŸš ç¨³å®šæ€§æµ‹è¯•

é•¿æ—¶é—´è¿è¡Œæ—¶è¿›è¡Œç¨³å®šæ€§æµ‹è¯•ï¼Œä¸»è¦é€šè¿‡`monkey`å‘½ä»¤ï¼Œåœ¨æµ‹è¯•åæœŸè¿›è¡Œã€‚

ğŸ™‹ æµ‹è¯•ç‰ˆçš„appï¼Œä¼šè®©å¼€å‘å°†è·³è½¬åˆ°å…¶ä»–åº”ç”¨çš„åŠŸèƒ½å±è”½æ‰å†æµ‹ã€‚

\#todoï¼Œiosçš„ç¨³å®šæ€§æµ‹è¯•

ğŸ“‹ æ­¥éª¤ï¼š

1. `adb shell monkey -p package -v 100000 -s 100 > E:\share\monkey.log`ï¼Œå‘ç¨‹åºå‘é€åä¸‡ä¸ªä¼ªéšæœºäº‹ä»¶ï¼Œå¹¶è®°å½•æ—¥å¿—ã€‚
2. æŸ¥çœ‹æ—¥å¿—æ£€æŸ¥è¿è¡Œå¤±è´¥çš„æ¬¡æ•°ï¼Œå¤±è´¥æ—¶éœ€åˆ†æå¼‚å¸¸ç±»å‹ã€‚
3. å›å½’æµ‹è¯•æ—¶ï¼Œä½¿ç”¨åŒæ ·çš„å‘½ä»¤æ‰§è¡Œï¼Œç¡®ä¿seedå€¼ä¸€è‡´ã€‚

---

å‚è€ƒèµ„æ–™ï¼š

1.[monkeyå‚æ•°è¯¦è§£](https://www.jianshu.com/p/c2aca7019ddf)

2.[monkeyä½¿ç”¨åœºæ™¯](https://www.cnblogs.com/TFBOYS0806/p/13578005.html)


## ğŸ“Œ appå¼‚å¸¸ç±»å‹

* ANR-å¼¹çª—æç¤ºæ— å“åº”
* Crash-å¼¹çª—æç¤ºå´©æºƒ
* åº”ç”¨é—ªé€€

!!! note "è¡¥å……"

      åŸç”Ÿå®‰å“ç³»ç»ŸANRã€Crashæ—¥å¿—ç­‰åœ¨`/data/system/dropbox`ã€`/data/anr/trace.txt`ç­‰ç›®å½•å¯æ‰¾åˆ°ï¼ˆè¿›å…¥dataç›®å½•éœ€è¦rootæƒé™ï¼‰ï¼Œä½†ä¸åŒæ‰‹æœºå‚å•†åŠ å®šåˆ¶åŒ–ç³»ç»Ÿæ—¶å¯èƒ½ç¼ºå°‘è¿™å±‚ç›®å½•ã€‚

### ANR

* æ—¥å¿—å…³é”®å­—ï¼š`anr in`
* åŸå› åˆ†æï¼š1.çº¿ç¨‹é˜»å¡ï¼›2.å†…å­˜ä¸è¶³ï¼›3.CPUæ»¡è´Ÿè·ï¼ˆç°åœ¨æ‰‹æœºæ€§èƒ½è¶Šæ¥è¶Šé«˜ï¼ŒåŸºæœ¬ä¸ä¼šå‡ºç°ï¼‰

### Crash

* æ—¥å¿—å…³é”®å­—ï¼š`null point`
* åŸå› åˆ†æï¼š1.ç©ºæŒ‡é’ˆï¼›2.æ•°ç»„è¶Šç•Œï¼›3.å†…å­˜ä¸è¶³ï¼›4.CPUæ»¡è´Ÿè·ï¼ˆç°åœ¨æ‰‹æœºæ€§èƒ½è¶Šæ¥è¶Šé«˜ï¼ŒåŸºæœ¬ä¸ä¼šå‡ºç°ï¼‰

### é—ªé€€

é€šè¿‡æŸ¥çœ‹logcatæ—¥å¿—è¿›è¡Œæ’æŸ¥


## ğŸ“Œ adbå¸¸ç”¨å‘½ä»¤

|                  å‘½ä»¤                   | è¡¥å……è¯´æ˜                                     |
|:-------------------------------------:|:-----------------------------------------|
|         `adb connect ip:port`         | è¿æ¥åˆ°è¿œç¨‹è®¾å¤‡                                  |
|    `adb -s ip:port install a.apk`     | æŒ‡å®šè®¾å¤‡å®‰è£…apk                                |
|            `adb shell ps`             | æŸ¥åå°è¿›ç¨‹                                    |
|      `adb shell dumpsys cpuinfo`      | æŸ¥çœ‹cpuä¿¡æ¯                                  |
|      `adb shell dumpsys meminfo`      | æŸ¥çœ‹å†…å­˜ä¿¡æ¯                                   |
|      `adb shell pm list package`      | æŸ¥çœ‹æ‰€æœ‰åŒ…åï¼Œå‚æ•°-3ä»…å±•ç¤ºç¬¬ä¸‰æ–¹åŒ…                       |
| `adb logcat -v time *:E > logcat.log` | æŸ¥çœ‹æ—¥å¿—ï¼Œå‚æ•°`-v time`æŒ‡åŠ ä¸Šæ—¶é—´æˆ³ï¼›`*:E`æŒ‡è·å–errorçº§åˆ«æ—¥å¿— |

!!! note "è¡¥å……"

    å¦‚éœ€ä»è®¾å¤‡å–æ–‡ä»¶ï¼Œæ‰§è¡Œ`adb pull`å³å¯ï¼›åŒç†`adb push`åˆ™æ˜¯æ¨é€æ–‡ä»¶ã€‚

    å®˜æ–¹æ–‡æ¡£ï¼š[Android è°ƒè¯•æ¡¥ (adb)](https://developer.android.google.cn/tools/adb?hl=zh-cn)

!!! note "20241217"

    `adb shell content query --uri content://sms/inbox --projection body --sort "date DESC" --limit 1`

    --projectionï¼Œåˆ—è¡¨ï¼›è·å–æœ€æ–°ä¸€æ¡çŸ­ä¿¡çš„å†…å®¹ï¼Œä½†vivo x200 Proæ‰§è¡Œè¯¥å‘½ä»¤æç¤ºï¼šæ— descã€limitå‚æ•°ã€‚
    
    `adb shell content query --uri content://sms/inbox --projection body --sort date`
    
    ç”¨è¯¥å‘½ä»¤åˆ™å¯ä»¥è·å–åˆ°å…¨éƒ¨çŸ­ä¿¡å†…å®¹ï¼Œå†æ­é…`str.splitlines()`è½¬åˆ—è¡¨æå–æœ€æ–°ä¸€æ¡çŸ­ä¿¡å†…å®¹ã€‚

---

å‚è€ƒèµ„æ–™ï¼š

[å¿«é€Ÿè·å–éªŒè¯ç ](https://cloud.tencent.com/developer/article/2308994)

### ğŸš logcatç¼“å†²åŒº

é»˜è®¤256Kï¼Œå†™æ»¡æ—¶ä¼šåˆ é™¤è¾ƒæ—§çš„æ—¥å¿—ã€‚æ­é…`-b Main`æŒ‡å®šç¼“å†²åŒºã€‚

* Radioï¼šè¾“å‡ºç³»ç»Ÿé€šä¿¡çš„æ—¥å¿—
* Systemï¼šè¾“å‡ºç³»ç»Ÿç»„ä»¶çš„æ—¥å¿—
* Eventsï¼šè¾“å‡ºäº‹ä»¶ï¼ˆæŒ‰é”®äº‹ä»¶ã€è§¦æ‘¸äº‹ä»¶ç­‰ï¼‰æ—¥å¿—
* Mainï¼šè¾“å‡ºä¸»ç¨‹åºï¼ˆJavaçš„mainæ–¹æ³•ï¼‰æ—¥å¿—ï¼Œä¸å±äºä¸Šè¿°ä¸‰å±‚

---