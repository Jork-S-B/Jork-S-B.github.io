
性能测试，评估系统整体性能的测试，主要指标有响应时间、吞吐量、资源利用率等。

* 压力测试，在强负载（大数据量、大量并发用户等）下的测试。
* 负载测试，在一定负载情况下的系统性能测试（不关注稳定性，也就是说不关注长时间运行，只是得到不同负载下相关性能指标即可），关注被测应用可以承受多少负载。

## 📌 需要关注的指标

吞吐量、响应时间和用户数量: 刚开始吞吐量随着用户数量的增加逐渐变大，当达到一定程度时，逐渐平缓直到变成一条平线；而响应时间随着用户数量的增长逐渐变大。

关注的指标: 并发数、响应时间、TPS-每秒处理事务数、QPS-每秒处理查询数、服务器资源。

🎬 场景: 并发数太高，吞吐量小，影响得到的响应时间准确性。

需要从小并发往上递增加压，TPS随之往上增长；当TPS不涨时，此时的并发数就是最佳并发数。

---

而当在最佳并发数下出现响应时间过长的情况时:

🤔 分析原因:

* 网络延迟: 检查网络状况，确保网络带宽和稳定性满足测试需求。（局域网一般影响不大）

* 服务器性能: 检查服务器CPU、内存等资源使用情况，判断是否由于资源不足导致性能下降。

* 接口设计: 检查接口是否涉及复杂计算或大量数据处理，这些操作可能导致响应时间延长。

* 代码优化: 分析代码实现，看是否存在可以优化的地方，如减少数据库查询次数、使用缓存等。

🔎 处理方法:

* 优化网络: 如果网络延迟是主要原因，可以尝试升级网络设备、优化网络配置或选择更稳定的网络环境进行测试。

* 升级服务器: 如果服务器性能不足，可以考虑升级服务器硬件或增加服务器数量来提高处理能力。

* 优化接口设计: 对于涉及复杂计算或大量数据处理的接口，可以尝试优化算法、减少数据处理量或采用异步处理方式来提高响应速度。

* 优化代码: 对代码进行性能分析，找出性能瓶颈并进行优化。可以考虑使用更高效的算法、减少数据库查询次数、使用缓存等技术来提高响应速度。

* 引入缓存机制: 对于经常访问的数据或计算结果，可以将其缓存在内存或缓存数据库中，以减少对数据库的访问次数，提高响应速度。

* 使用分布式缓存: 将经常访问的数据缓存到内存中，以减少数据库的访问次数，提高接口的响应速度。


## 📌 OOM

服务器内存足够大，出现OOM的原因分析：

* 内存泄漏: 程序设计时的失误，代码运行完成后未能正确回收/释放资源。结果导致程序性能下降，最终可能引发系统崩溃。  
内存溢出: 内存泄漏会引发内存溢出，程序试图分配超过实际可用的内存大小。
* 高并发请求
* 不合理的内存分配
* 多进程/多线程的资源竞争
    
通过长时间压测，可以发现内存泄漏问题，报错OutOfMemory 或 OOM。

或者压测结束后，CPU使用率一直未下降，可能也是内存泄漏问题。

## 📌 性能测试报告

1. 概述: 编写目的、项目背景、系统简介、测试目标
2. 性能测试环境: 服务器软硬件环境、测试环境与配置、人员与时间安排、测试工具
3. 性能测试用例场景: 核心业务、复合业务等
4. 性能测试分析与调优: 压测结果数据分析，记录调优方案，用于后续项目的参考
5. 性能测试结论汇总

## 📌 面试题

### 🚁 接口响应慢怎么办

1. **分析原因**：复现问题，详细分析对应接口性能瓶颈，如排查是否存在上下游依赖、涉及静态资源使用CDN加快访问速度。
2. **日志和监控分析**：通过日志和监控工具如 Prometheus、Grafana 等，确认根因。
3. **优化代码与算法**：检查是否有可优化的算法或多余的计算。
4. **数据库优化**：检查是否有数据库性能瓶颈，如索引、SQL优化等。
5. **缓存机制**：针对不频繁变动的数据，采用缓存机制，减少数据库查询次数。
6. **系统架构调整**：根据需求适当引入异步处理、消息队列、多线程多进程提高处理速度。
7. **硬件和网络**：检查服务器硬件性能、网络带宽是否满足要求。
 
---




