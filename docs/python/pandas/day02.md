## ğŸ“Œ NumPy

`Pandas`æ˜¯åŸºäº`NumPy`æ„å»ºçš„ï¼Œå› æ­¤å®ƒå†…éƒ¨ç¡®å®ä½¿ç”¨äº†`ndarray`æ¥å®ç°å…¶æ ¸å¿ƒæ•°æ®ç»“æ„ã€‚

`ndarray`ï¼Œå¤šç»´æ•°ç»„å¯¹è±¡ï¼Œ è€Œ`Series`å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªå¸¦ç´¢å¼•çš„`ndarray`ã€‚

```python
import numpy as np
import pandas as pd

# åˆ›å»ºä¸€ä¸ªndarray
arr = np.array([1, 2, 3, 4, 5])
print(arr)  # è¾“å‡º: [1 2 3 4 5]

# åˆ›å»ºå¤šç»´æ•°ç»„ï¼Œå¹¶æŒ‡å®šæ•°æ®ç±»å‹
multi_dim_arr = np.array([[1, 2, 3], [4, 5, 6]], dtype=np.int32)

# ndarrayè½¬æ¢æ•°æ®ç±»å‹
arr_float = arr.astype(np.float64)
print(arr_float)  # è¾“å‡º: [1. 2. 3. 4. 5.]

# ç‰¹æ®Šå€¼
# np.nan: è¡¨ç¤ºç¼ºå¤±å€¼æˆ–æœªå®šä¹‰çš„æ•°å€¼ã€‚
# np.inf å’Œ -np.inf: è¡¨ç¤ºæ­£æ— ç©·å’Œè´Ÿæ— ç©·ã€‚
special_values = np.array([np.nan, np.inf, -np.inf])
print(special_values)  # è¾“å‡º: [ nan  inf -inf ]
print(special_values.dtype)  # è¾“å‡º: float64

# åˆ›å»ºä¸€ä¸ªSeries
s = pd.Series([1, 2, 3, 4, 5])
print(s.values)  # è¾“å‡º: [1 2 3 4 5]ï¼Œç±»å‹ä¸º ndarray

```

!!! note "è¡¥å……"

    * `ndarray`æ˜¯è¿ç»­å­˜å‚¨åœ¨å†…å­˜ä¸­çš„ï¼Œå¹¶ä¸”æ”¯æŒé«˜æ•ˆçš„å‘é‡åŒ–æ“ä½œã€‚

    * `ndarray`å¯ç›´æ¥è½¬æ¢ä¸º`Pandas`çš„æ•°æ®ç»“æ„ï¼ˆå¦‚`DataFrame`ï¼‰ï¼Œåä¹‹äº¦ç„¶ã€‚

## ğŸ“Œ å­¦ä¹ ä¸€äº›åŠŸèƒ½

### ğŸš ç”Ÿæˆä¸€ä¸ªéšæœºæ•°ç»„

np.random.randn(10)

### ğŸš ç”Ÿæˆæœä»æ­£æ€åˆ†å¸ƒçš„æ•°æ®

np.random.normal(0.0005, 0.02, 1000)  
ç”Ÿæˆ1000ä¸ªæœä»æ­£æ€åˆ†å¸ƒçš„æ—¥æ”¶ç›Šç‡ï¼ˆå‡å€¼ä¸º0.0005ï¼Œæ ‡å‡†å·®ä¸º0.02ï¼‰

### ğŸš å‘é‡åŒ–è¿ç®—

ç”¨æ•°ç»„æ“ä½œæ›¿ä»£å¾ªç¯ï¼Œæå‡è®¡ç®—æ•ˆç‡ã€‚

=== "è®¡ç®—ç´¯è®¡æ”¶ç›Šç‡"

    ```python
    import numpy as np
    
    # ç”Ÿæˆ1000ä¸ªæœä»æ­£æ€åˆ†å¸ƒçš„æ—¥æ”¶ç›Šç‡ï¼ˆå‡å€¼ä¸º0.0005ï¼Œæ ‡å‡†å·®ä¸º0.02ï¼‰
    returns = np.random.normal(0.0005, 0.02, 1000)
    
    # è®¾ç½®æ‰“å°é€‰é¡¹ï¼ŒæŠ‘åˆ¶ç§‘å­¦è®¡æ•°æ³•ï¼Œè®¾ç½®ä¸ºå°æ•°ç‚¹å6ä½
    np.set_printoptions(suppress=True, precision=6)
    
    # å‘é‡åŒ–è®¡ç®—ç´¯è®¡æ”¶ç›Šç‡
    # 1 + returns, æ¯ä¸ªå…ƒç´ +1; np.cumprod, æ¯ä¸ªå…ƒç´ ç´¯ç§¯ä¹˜ç§¯è¿ç®—ï¼Œå³nums[i] = nums[i] * nums[i-1]
    cumulative_returns = np.cumprod(1 + returns) - 1
    
    print(f'1000ä¸ªäº¤æ˜“æ—¥çš„ç´¯è®¡æ”¶ç›Šç‡ä¸º{cumulative_returns[-1] * 100:.2f}%')
    ```

=== "æ­£æ€åˆ†å¸ƒå¯è§†åŒ–"

    ```python
    import numpy as np
    import matplotlib.pyplot as plt
    import seaborn as sns
    
    # ç”Ÿæˆ1000ä¸ªæœä»æ­£æ€åˆ†å¸ƒçš„æ—¥æ”¶ç›Šç‡ï¼ˆå‡å€¼ä¸º0.0005ï¼Œæ ‡å‡†å·®ä¸º0.02ï¼‰
    returns = np.random.normal(0.0005, 0.02, 1000)
    
    # è®¾ç½®æ‰“å°é€‰é¡¹ï¼ŒæŠ‘åˆ¶ç§‘å­¦è®¡æ•°æ³•ï¼Œè®¾ç½®ä¸ºå°æ•°ç‚¹å6ä½ã€‚
    np.set_printoptions(suppress=True, precision=6)
    
    # å‘é‡åŒ–è®¡ç®—ç´¯è®¡æ”¶ç›Šç‡
    # 1 + returns, æ¯ä¸ªå…ƒç´ +1; np.cumprod, æ¯ä¸ªå…ƒç´ ç´¯ç§¯ä¹˜ç§¯è¿ç®—ï¼Œå³nums[i] = nums[i] * nums[i-1]
    cumulative_returns = np.cumprod(1 + returns) - 1
    
    print(f'1000ä¸ªäº¤æ˜“æ—¥çš„ç´¯è®¡æ”¶ç›Šç‡ä¸º{cumulative_returns[-1] * 100:.2f}%')
    
    # è®¾ç½®ä¸­æ–‡å­—ä½“
    plt.rcParams['font.sans-serif'] = ['SimHei']  # ä½¿ç”¨é»‘ä½“
    plt.rcParams['axes.unicode_minus'] = False  # è§£å†³è´Ÿå·æ˜¾ç¤ºé—®é¢˜
    
    # ç»˜åˆ¶ç›´æ–¹å›¾
    plt.figure(figsize=(12, 6))
    
    # ç»˜åˆ¶ç›´æ–¹å›¾
    # bins=30: æŒ‡å®šç›´æ–¹å›¾çš„æŸ±æ•°ã€‚
    # alpha=0.6: è®¾ç½®é€æ˜åº¦ã€‚
    # color='g': è®¾ç½®é¢œè‰²ä¸ºç»¿è‰²ã€‚
    plt.hist(returns, bins=30, density=True, alpha=0.6, color='g', label='Histogram-ç›´æ–¹å›¾')
    
    # ç»˜åˆ¶æ ¸å¯†åº¦ä¼°è®¡å›¾
    sns.kdeplot(returns, color='r', label='Kernel Density Estimate-æ ¸å¯†åº¦ä¼°è®¡å›¾')
    
    # æ·»åŠ æ ‡é¢˜å’Œæ ‡ç­¾
    plt.title('Distribution of Daily Returns-æ—¥æ”¶ç›Šç‡çš„æ­£æ€åˆ†å¸ƒå›¾')
    plt.xlabel('Daily Returns-æ—¥æ”¶ç›Šç‡')
    plt.ylabel('Density-å¯†åº¦')
    plt.legend()
    
    plt.show()
    
    ```

### ğŸš æ±‚å¹³å‡å€¼

nums.mean(axis=1), æ²¿ç€è¡Œæ±‚å¹³å‡å€¼ã€‚

nums.mean(axis=0), æ²¿ç€åˆ—æ±‚å¹³å‡å€¼ã€‚

### ğŸš ä¿®æ”¹æ•°ç»„å½¢çŠ¶/ç»´åº¦

nums.reshape(-1, 1), -1è¡¨ç¤ºè‡ªåŠ¨è®¡ç®—è¯¥ç»´åº¦çš„å¤§å°, 1 è¡¨ç¤ºç¬¬äºŒç»´åº¦çš„å¤§å°ä¸º1ã€‚

### ğŸš å¹¿æ’­æœºåˆ¶

å…è®¸ä¸åŒå½¢çŠ¶çš„æ•°ç»„è¿›è¡Œç®—æœ¯è¿ç®—ï¼Œè€Œæ— éœ€æ˜¾å¼åœ°å¤åˆ¶æ•°æ®ã€‚

å¹¿æ’­è§„åˆ™ä½¿å¾—æ•°ç»„å¯ä»¥è‡ªåŠ¨æ‰©å±•ä»¥åŒ¹é…å½¼æ­¤çš„å½¢çŠ¶ï¼Œä»è€Œè¿›è¡Œå…ƒç´ çº§æ“ä½œã€‚

#### ğŸ”§ å¹¿æ’­çš„åŸºæœ¬è§„åˆ™

* å¯¹é½ç»´åº¦: ä»åå‘å‰å¯¹é½ä¸¤ä¸ªæ•°ç»„çš„ç»´åº¦ã€‚å¦‚æœä¸¤ä¸ªç»´åº¦çš„å¤§å°ç›¸åŒæˆ–å…¶ä¸­ä¸€ä¸ªç»´åº¦çš„å¤§å°ä¸º1ï¼Œåˆ™è®¤ä¸ºå®ƒä»¬æ˜¯å…¼å®¹çš„ã€‚
* æ‰©å±•ç»´åº¦: å¦‚æœä¸¤ä¸ªç»´åº¦çš„å¤§å°ä¸åŒï¼Œä¸”å…¶ä¸­ä¸€ä¸ªç»´åº¦çš„å¤§å°ä¸º1ï¼Œåˆ™è¯¥ç»´åº¦ä¼šè¢«æ‰©å±•ä»¥åŒ¹é…å¦ä¸€ä¸ªç»´åº¦çš„å¤§å°ã€‚
* ä¸å…¼å®¹çš„æƒ…å†µ: å¦‚æœä¸¤ä¸ªç»´åº¦çš„å¤§å°ä¸åŒä¸”éƒ½ä¸ä¸º1ï¼Œåˆ™æ— æ³•è¿›è¡Œå¹¿æ’­ï¼Œä¼šå¼•å‘`ValueError`ã€‚(å¦‚2è¡Œ2åˆ—å’Œ2è¡Œ3åˆ—)

=== "å¯¹é½ç»´åº¦å’Œæ‰©å±•ç»´åº¦"

    ```python
    import numpy as np
    
    a = np.array([[1, 2, 3], [4, 5, 6]])  # å½¢çŠ¶ä¸º (2, 3)-2è¡Œ3åˆ—
    b = np.array([1, 2])  # å½¢çŠ¶ä¸º (2,)-1è¡Œ2åˆ—
    
    # ç›´æ¥å¹¿æ’­è¿ç®—æ—¶ä¼šæŠ¥ValueError
    b = b.reshape(-1, 1)  # æ”¹å˜å½¢çŠ¶ä¸º (2, 1)-2è¡Œ1åˆ—
    
    # ä½¿ç”¨å¹¿æ’­è¿›è¡Œå‡æ³•è¿ç®—
    c = a - b
    
    print("a-b:\n", c)
    # [[0 1 2]
    # [2 3 4]]
    ```
